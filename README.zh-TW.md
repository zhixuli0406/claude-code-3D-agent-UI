[English](./README.md) | [繁體中文](./README.zh-TW.md)

# Claude Code 3D Agent UI

一款 macOS 應用程式，將 Claude Code CLI 的代理執行過程轉化為沉浸式的 3D 視覺化環境，結合遊戲化設計、豐富動畫和生產力工具。

![Platform](https://img.shields.io/badge/platform-macOS%2014%2B-blue)
![Swift](https://img.shields.io/badge/Swift-5.9-orange)
![Framework](https://img.shields.io/badge/framework-SwiftUI%20%2B%20SceneKit-green)

---

## 功能特色

### 3D 場景主題

9 款精心設計的互動環境：

| 主題 | 說明 |
|------|------|
| 指揮中心 | 配備全息顯示器的高科技控制室 |
| 浮空島嶼 | 有橋樑相連的空中仙境島嶼 |
| 地下城 | 幽暗神秘的地下密室 |
| 太空站 | 零重力科幻太空站 |
| 賽博龐克城市 | 霓虹燈照耀的街道與全息廣告牌 |
| 中世紀城堡 | 騎士風格代理人的王座大廳 |
| 水下實驗室 | 充滿氣泡和魚群的潛水基地 |
| 日式庭園 | 櫻花飄落的禪意花園 |
| Minecraft 世界 | 經典像素風格地形 |

### 像素角色系統

- 全關節像素代理人，可自訂身體部件
- 超過 15 種裝飾帽子與配件（皇冠、光環、披風、耳機）
- 每個代理人可設定粒子拖尾特效
- 自訂名牌與稱號

### 互動功能

- **點擊互動** — 選取代理人、雙擊追蹤、右鍵選單
- **拖放操作** — 將任務拖曳到代理人上進行指派
- **對話氣泡** — 即時語音／思考氣泡搭配打字動畫
- **攝影機控制** — 自由環繞、聚焦代理人、電影預設、子母畫面、第一人稱視角
- **互動時間軸** — 可捲動的事件歷史，支援篩選與匯出

### 遊戲化系統

- **經驗值與等級** — 代理人累積經驗、升級並解鎖裝飾品
- **成就系統** — 超過 10 種可解鎖成就（初次擊殺、極速惡魔、除蟲大師、夜貓子等）
- **數據儀表板** — 任務完成率、排行榜、歷史圖表、熱力圖
- **裝飾商店** — 使用獲得的金幣購買外觀、帽子、粒子特效
- **連擊系統** — 連續追蹤與倍率加成
- **小地圖** — 戰爭迷霧探索，隱藏彩蛋與劇情物品

### 動畫與特效

- 16 種動畫類型（勝利舞蹈、沮喪、協作、睡眠、傳送、走向桌面等）
- 粒子特效（火花、煙霧、程式碼雨、閃電、環境主題粒子）
- 日夜循環同步真實世界時間
- 天氣效果隨任務成功率變化
- 互動場景物件（可點擊的螢幕、可開啟的門）
- 流暢的主題切換搭配傳送門／扭曲特效

### 生產力與監控

- **任務佇列** — 視覺化浮動卡片，依優先級標色，支援拖曳排序
- **多視窗** — 彈出式 CLI 輸出、可分離面板、浮動監控器、多螢幕支援
- **通知** — macOS 原生通知搭配可自訂音效
- **效能指標** — 即時 Token 使用量、費用估算、任務持續時間追蹤
- **音效** — 完成提示音、錯誤警告、鍵盤聲、升級慶祝音效
- **背景音樂** — 主題專屬程序化環境音樂，動態強度隨工作活動變化

### Git 整合視覺化

- **3D 差異面板** — 在 3D 空間中以浮動程式碼區塊顯示已暫存/未暫存變更，增刪行以顏色區分
- **分支樹狀結構** — 互動式分支視覺化，旋轉樹狀結構搭配當前分支高亮
- **提交歷史時間軸** — 3D 提交歷史搭配代理頭像關聯與提交詳情
- **PR 工作流程** — 建立 Pull Request 搭配 3D 場景中的視覺預覽卡片（需安裝 `gh` CLI）

### 多模型支援

- **模型選擇** — 為每個代理團隊選擇 Claude Opus、Sonnet 或 Haiku 模型
- **視覺指示器** — 3D 角色與代理詳情面板上的顏色編碼模型標章
- **模型比較** — 並排比較不同模型的輸出結果，支援平行執行

### 提示詞模板

- **模板庫** — 瀏覽、搜尋及管理提示詞模板，支援分類篩選
- **內建模板** — 10 個預建模板，涵蓋錯誤修復、功能開發、程式重構與程式碼審查
- **自訂模板** — 建立、編輯及刪除您自己的可重用提示詞模板
- **快速啟動選單** — 直接從提示詞輸入列快速選取模板，附帶最近使用記錄
- **變數替換** — 動態 `{{variable}}` 佔位符，搭配即時預覽與預設值

### AI 增強功能

- **RAG 系統** — 本地知識庫搭配 SQLite FTS5 全文搜尋，自動索引專案檔案、語義搜尋、上下文自動注入 Prompt，以及 3D 知識圖譜視覺化
- **Agent 記憶系統** — 長期記憶存儲任務摘要、跨工作階段的上下文回憶、時間軸氣泡視覺化、Agent 間知識共享、相關性排序
- **智慧任務分解** — 自動子任務拆解、3D 依賴關係圖視覺化、根據 Agent 歷史表現的智慧分配建議、並行執行規劃、複雜度估算
- **Prompt 智慧優化** — 品質評分、自動補全建議、歷史分析、A/B 測試框架、Prompt 版本管理
- **語義查詢與意圖分類** — NLP 預處理管道，支援語言偵測、分詞、實體抽取；規則型 + AI 混合意圖分類（16 種意圖類型）；整合 RAG、直接匹配、Agent 記憶的統一搜尋協調器；多維度結果排序（BM25、語義相關性、實體匹配、時間新鮮度、依賴圖近似性）

### 開發工作流程整合

- **CI/CD 視覺化** — 在 3D 場景中監控 GitHub Actions 狀態、構建結果動畫、部署進度追蹤、PR 審核進度顯示
- **測試覆蓋率視覺化** — 3D 覆蓋率熱力圖、即時測試結果動畫、覆蓋率趨勢追蹤、未覆蓋區域高亮
- **程式碼品質儀表板** — 靜態分析整合（SwiftLint、ESLint）、技術債追蹤、3D 程式碼複雜度視覺化、重構建議
- **多專案工作區** — 同時監控多個專案的 Agent 活動、跨專案任務搜尋、流暢專案切換過渡動畫、專案級別效能比較
- **Docker 整合** — 3D 場景中的容器狀態監控、即時容器日誌串流、一鍵環境啟動/停止、CPU/記憶體/網路資源視覺化

### 進階視覺化

- **程式碼知識圖譜** — 3D 檔案依賴關係圖，節點與連線視覺化、即時變更傳播高亮、函數呼叫鏈動畫、架構鳥瞰圖
- **即時協作視覺化** — 多 Agent 協作路徑動畫、共享資源存取衝突顯示、任務交接過渡效果、團隊效率雷達圖
- **AR/VR 支援** — visionOS 適配 Apple Vision Pro 空間計算、手勢控制 3D Agent 互動、空間音效定位、沉浸式工作環境
- **資料流動畫** — Token 串流粒子流動視覺化、輸入/輸出管道動畫、工具呼叫鏈視覺化

### 開發工作流程與智慧化

- **工作流程自動化** — 視覺化工作流程編輯器，支援觸發式執行（Git Push、檔案變更、排程），逐步進度追蹤、內建模板（PR 審核、Bug 修復），以及 3D 工作流程節點視覺化
- **智慧排程** — AI 驅動的任務排程，支援優先級優化、資源使用率追蹤、時間槽管理、自動排程，以及 3D 時間軸視覺化
- **異常偵測與自修復** — 即時監控無限迴圈、過度 Token 消耗、重複錯誤、記憶體洩漏及速率限制風險；可設定重試策略（指數退避、線性、立即）；錯誤模式追蹤搭配 3D 警告視覺化
- **MCP 整合** — Model Context Protocol 伺服器管理，支援工具發現、呼叫記錄、延遲追蹤，以及 3D 中心輻射式伺服器與工具連接視覺化

### 分析與報告（M 系列）

- **進階分析儀表板（M1）** — 自訂報表建構器，支援 6 種小工具類型（折線圖、長條圖、圓餅圖、指標卡、表格、熱力圖）、6 種資料來源、趨勢預測（含信賴區間）、成本優化建議（含預估節省金額）、跨模型與代理人的效能基準測試，以及 3D 分析樞紐視覺化（脈動球體與旋轉環）
- **報表匯出與生成（M2）** — 支援 JSON、CSV、Markdown、PDF 四種匯出格式；可重用報表模板（含 6 種章節類型：執行摘要、Token 使用量、成本分析、任務指標、錯誤分析、效能趨勢）；自動排程（每日/每週/雙週/每月）；匯出作業追蹤（含進度指示器）；3D 文件樞紐視覺化（格式特定幾何形狀）
- **API 使用分析（M3）** — 逐次呼叫指標追蹤（Token、延遲、成本、錯誤）、依模型與任務類型的成本分解、預算警報（3 個嚴重等級：正常/警告/嚴重）、使用預測（趨勢偵測與月底預估）、每模型統計，以及 3D 使用量計量器（預算環與模型使用柱）

### SkillsMP 整合

- 瀏覽並匯入社群 SkillsMP 市集中的技能
- 直接將技能安裝至 Agent 工作流程

### CLI 整合

- 啟動並管理 Claude Code CLI 程序
- 非阻塞串流讀取搭配即時輸出解析
- 工具呼叫計數與進度估算
- 支援工作階段恢復
- 工作區管理
- 工作階段歷史記錄與回放功能

### 在地化

- 支援英文與繁體中文，可於執行時切換語言

### 鍵盤快捷鍵

- **F1** — 顯示/隱藏快捷鍵指南
- **Escape** — 退出第一人稱視角模式

---

## 系統需求

- macOS 14（Sonoma）或更新版本
- 已安裝 [Claude Code CLI](https://docs.anthropic.com/en/docs/claude-code) 並加入 `PATH`
- Swift 5.9+

## 安裝與建置腳本

### 快速安裝（一鍵完成）

`install.sh` 會檢查先決條件、建置 Release 執行檔、打包為 `.app` 套件，並複製到 `/Applications`：

```bash
cd AgentCommand
./install.sh
```

腳本會自動執行以下檢查：
1. 確認 Swift 工具鏈可用
2. 確認 macOS 版本為 14（Sonoma）或更新
3. 解析 Swift Package 相依套件
4. 建置 Release 執行檔
5. 打包 `.app` 套件，包含 `Info.plist` 與資源
6. 安裝至 `/Applications/AgentCommand.app`

安裝完成後，啟動應用程式：

```bash
open /Applications/AgentCommand.app
```

### 僅建置（不安裝）

`build-app.sh` 建置專案並在 `dist/` 目錄下產生 `.app` 套件，不會安裝：

```bash
cd AgentCommand

# Release 建置（預設）
./build-app.sh

# Debug 建置
./build-app.sh debug
```

輸出的 `.app` 套件位於 `AgentCommand/dist/AgentCommand.app`。啟動方式：

```bash
open dist/AgentCommand.app
```

### 使用 Swift CLI 手動建置

若您偏好不使用腳本手動建置：

```bash
cd AgentCommand
swift package resolve   # 解析相依套件
swift build             # Debug 建置
swift build -c release  # Release 建置
```

直接執行：

```bash
swift run AgentCommand
```

### 使用 Xcode 開啟

在 Xcode 中開啟 `AgentCommand/Package.swift` 即可建置與執行。

## 專案結構

```
AgentCommand/
├── App/                  # 應用程式入口與全域狀態
├── Models/               # 資料模型（Agent、Achievement、Cosmetic、Skill、RAG、Memory、Workflow、MCP、Semantic Query、CI/CD、Docker、Analytics Dashboard、Report Export、API Usage 等）
├── Services/             # 業務邏輯（CLI 程序、RAG、記憶系統、任務分解、語義查詢、工作流程、排程、異常偵測、MCP、CI/CD、Docker、分析儀表板、報表匯出、API 使用分析等）
├── Views/
│   ├── Components/       # 可重用 UI 元件
│   ├── Overlays/         # 成就展示、裝飾商店、小地圖、RAG 狀態、
│   │                     #   Agent 記憶、任務分解、Prompt 優化、
│   │                     #   工作流程、排程、異常偵測、MCP、CI/CD、
│   │                     #   測試覆蓋率、程式碼品質、Docker、知識圖譜、
│   │                     #   分析儀表板、報表匯出、API 使用分析等
│   ├── Panels/           # 代理人詳情、CLI 輸出、任務列表、模型比較面板
│   ├── Windows/          # 多視窗管理
│   └── Timeline/         # 時間軸視圖
├── Scene3D/
│   ├── Themes/           # 9 種主題建構器
│   ├── Voxel/            # 像素角色系統（身體、帽子、粒子、名牌）
│   ├── Animation/        # 16 種動畫控制器
│   ├── Effects/          # 粒子、對話氣泡、天氣、日夜循環、
│   │                     #   RAG／任務分解／Prompt 優化視覺化、
│   │                     #   工作流程／排程／異常偵測／MCP 視覺化、
│   │                     #   CI/CD／測試覆蓋率／程式碼品質／Docker／
│   │                     #   知識圖譜／協作／資料流／多專案視覺化、
│   │                     #   分析儀表板／報表匯出／API 使用分析視覺化
│   └── Environment/      # 房間、桌子、螢幕、燈光、多團隊佈局
├── Utilities/            # 輔助工具函式
└── Resources/            # 素材與範例配置
```

## 開發路線圖

完整功能待辦清單請參閱 [TODO-features.md](./TODO-features.md) 及 [TODO-next-features.md](./TODO-next-features.md)。即將推出的項目包括：

- 主題市集與社群分享
- 即時多人協作
- 語音控制與外掛系統

## 授權條款

保留所有權利。
